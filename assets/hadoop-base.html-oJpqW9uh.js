import{_ as i}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as l,o,c as d,a as n,b as s,e as t,f as a}from"./app-HyF_wsaK.js";const p="/assets/Untitled-SuQ3d9vO.png",c="/assets/Untitled1-DHJ8Blo9.png",r="/assets/Untitled2-p1Bqmv85.png",u="/assets/Untitled3-UTPA1GYQ.png",m="/assets/Untitled4-ZFoIVjRG.png",v="/assets/Untitled5-gvdwSzDZ.png",g="/assets/Untitled6-f9mw6MK3.png",b="/assets/Untitled7-J2-PJpao.png",h="/assets/Untitled8-0AZFIdGe.png",k="/assets/Untitled9-r3U_HjMh.png",f="/assets/Untitled10-zzEEFa4E.png",x="/assets/Untitled11-zwLK7Q1l.png",y="/assets/Untitled12-NYikIEhU.png",_="/assets/Untitled13-PJhYVYLM.png",A="/assets/Untitled14-uJAYorkK.png",U="data:image/png;base64,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",H="/assets/Untitled16-nNbm0sXf.png",w="/assets/Untitled17-KIjck6iD.png",q="/assets/Untitled18-iJLXVTwB.png",N="/assets/Untitled19-inuitOVX.png",D="/assets/Untitled20-RUKKA4Ql.png",j="/assets/Untitled21-l7IQuUlO.png",O="/assets/Untitled22-o_vOlbkm.png",R="/assets/Untitled23-5hFphTbe.png",P="/assets/Untitled24-Ptc3FB9R.png",M="/assets/Untitled25-IQwLD4_f.png",L="/assets/Untitled26-Yk8O7KAE.png",S={},z=a(`<h2 id="hadoop运行环境搭建-开发重点" tabindex="-1"><a class="header-anchor" href="#hadoop运行环境搭建-开发重点" aria-hidden="true">#</a> Hadoop运行环境搭建（开发重点）</h2><h2 id="_1-1-模板虚拟机环境准备" tabindex="-1"><a class="header-anchor" href="#_1-1-模板虚拟机环境准备" aria-hidden="true">#</a> 1.1 模板虚拟机环境准备</h2><p>安装虚拟机，可参考k8s中的介绍文章</p><blockquote><p>虚拟机处理器配置：所有虚拟机处理器内核数&lt;当前虚拟机cpu数量</p></blockquote><p>创建新的磁盘：磁盘大小推荐为50G</p><p><strong>1）、安装epel-release</strong></p><p>注：Extra Packages for EnterpriseLinux 是为 “红帽系”的操作系统提供额外的软件包，适用于RHEL、CentOS和Scientific Linux 。相当于是一个软件仓库，大多数rpm包在官方的 repository 中是找不到的</p><p><code>yum install -y epel-release</code></p><blockquote><p>注意：如果 Linux 安装的是最小系统版，还需要安装如下工具；如果安装的是Linux 桌面标准版，不需要执行如下操作</p></blockquote><ul><li>[ ] net-tool:工具包集合，包含ifconfig等命令<code>yum install -y net-tools</code></li><li>[ ] vim：编辑器<code>yum install -y vim</code></li></ul><p><strong>2）、关闭防火樯，关闭防火墙开启自启</strong></p><p><code>systemctl stop firewalld</code></p><p><code>systemctl disable firewalld.service</code></p><blockquote><p>注意：在企业开发中，通常单个服务器的防火墙是关闭的。公司整体会对外设置非常安全的防火墙</p></blockquote><p><strong>3）、创建用户，并修改用户密码:begin123</strong></p><p><code>useradd begin</code></p><p><code>passwd begin</code></p><p><strong>4）、配置begin用户具有root权限。方便后期sudo执行root权限的命令</strong></p><p>vim /etc/sudoers</p><p>修改/etc/sudoers 文件，在%wheel 这行下面添加一行，如下所示：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>## <span class="token class-name">Allow</span> root <span class="token keyword">to</span> <span class="token namespace">run</span> any commands amywhere
root    <span class="token constant">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">ALL</span><span class="token punctuation">)</span>     <span class="token constant">ALL</span>
## <span class="token class-name">Allow</span> people in group wheel <span class="token keyword">to</span> <span class="token namespace">run</span> all commands
<span class="token operator">%</span>wheel <span class="token constant">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">ALL</span><span class="token punctuation">)</span>    <span class="token constant">ALL</span>
begin  <span class="token constant">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">ALL</span><span class="token punctuation">)</span>  <span class="token constant">NOPASSWD</span><span class="token operator">:</span><span class="token constant">ALL</span>        <span class="token operator">&lt;</span><span class="token operator">--</span><span class="token operator">--</span>此行
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：begin这一行不要直接放到root 行下面，因为所有的用户都属于wheel组，你先配置了begin 具有免密功能，但是程序执行到 %wheel 行是，该功能又被覆盖回需要密码。所以这里要放到 %wheel 这行下面。</p><p><strong>5）、在/opt目录下创建文件夹，并修改所属主和所属组</strong></p><figure><img src="`+p+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><p><strong>6）、卸载虚拟机自带的JDK</strong></p><p>最小化安装忽略此步</p><h3 id="克隆虚拟机" tabindex="-1"><a class="header-anchor" href="#克隆虚拟机" aria-hidden="true">#</a> 克隆虚拟机</h3><figure><img src="'+c+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ul><li>选择完整克隆</li><li>配置静态IP地址<code>cd /etc/sysconfig/network-scripts</code></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token constant">TYPE</span><span class="token operator">=</span><span class="token string">&quot;Ethernet&quot;</span>
<span class="token constant">PROXY_METHOD</span><span class="token operator">=</span><span class="token string">&quot;none&quot;</span>
<span class="token constant">BROWSER_ONLY</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token constant">BOOTPROTO</span><span class="token operator">=</span><span class="token string">&quot;static&quot;</span>
<span class="token constant">DEFROUTE</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token constant">IPV4_FAILURE_FATAL</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token constant">IPV6INIT</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token constant">IPV6_AUTOCONF</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token constant">IPV6_DEFROUTE</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token constant">IPV6_FAILURE_FATAL</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token constant">IPV6_ADDR_GEN_MODE</span><span class="token operator">=</span><span class="token string">&quot;stable-privacy&quot;</span>
<span class="token constant">NAME</span><span class="token operator">=</span><span class="token string">&quot;ens33&quot;</span>
<span class="token constant">UUID</span><span class="token operator">=</span><span class="token string">&quot;2ffdc083-6d7c-441d-a5f6-313c80b9dd74&quot;</span>
<span class="token constant">DEVICE</span><span class="token operator">=</span><span class="token string">&quot;ens33&quot;</span>
<span class="token constant">ONBOOT</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token constant">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.158</span><span class="token number">.130</span>
<span class="token constant">NETMASK</span><span class="token operator">=</span><span class="token number">255.255</span><span class="token number">.255</span><span class="token number">.0</span>
<span class="token constant">GATEWAY</span><span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.158</span><span class="token number">.2</span>
<span class="token constant">DNS</span><span class="token operator">=</span><span class="token number">8.8</span><span class="token number">.8</span><span class="token number">.8</span>
<span class="token constant">ZONE</span><span class="token operator">=</span><span class="token keyword">public</span>
<span class="token constant">NM_CONTROLLED</span><span class="token operator">=</span>no
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>设置路由</li></ul><ol><li><strong>route -n --检查路由</strong></li><li><strong>vim /etc/resolv.conf --添加DNS</strong></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Generated</span> by <span class="token class-name">NetworkManager</span>

search localdomain
nameserver <span class="token number">114.114</span><span class="token number">.114</span><span class="token number">.114</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、<strong>添加永久静态路由</strong></p><p><code>vi /etc/sysconfig/network-scripts/route-ens33</code>（没有该文件就新建一个）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token number">192.168</span><span class="token number">.158</span><span class="token number">.0</span><span class="token operator">/</span><span class="token number">24</span> via <span class="token number">192.168</span><span class="token number">.158</span><span class="token number">.2</span>
<span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">/</span><span class="token number">0</span> via <span class="token number">192.168</span><span class="token number">.158</span><span class="token number">.2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>4、重启网卡，完成</p><p><strong><code>service network restart</code> --重启网卡，使之生效</strong></p><h3 id="安装jdk-hadoop" tabindex="-1"><a class="header-anchor" href="#安装jdk-hadoop" aria-hidden="true">#</a> 安装JDK&amp;Hadoop</h3><h3 id="安装jdk" tabindex="-1"><a class="header-anchor" href="#安装jdk" aria-hidden="true">#</a> 安装JDK</h3><ol><li>进入指定目录，没有新建一个 <code>cd /opt/software</code></li></ol><figure><img src="`+r+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>解压到指定目录 <code>tar -zxvf jdk-…..jar -C /opt/module/</code></li></ol><figure><img src="'+u+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><figure><img src="'+m+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>配置java环境变量</li></ol><p>创建文件 <code>sudo vim my_env.sh</code> 注意路径</p><figure><img src="'+v+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><p>添加内容如下，JAVA_HOME为jdk安装包路径：</p><figure><img src="'+g+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><p>添加完成后刷新配置，完成 <code>source /etc/profile</code></p><figure><img src="'+b+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h3 id="安装hadoop" tabindex="-1"><a class="header-anchor" href="#安装hadoop" aria-hidden="true">#</a> 安装Hadoop</h3><ol><li>同样解压到指定目录<code>tar -zxvf hadoop-3.1.3.tar.gz -C /opt/module</code></li></ol><figure><img src="'+h+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>配置环境变量</li></ol><figure><img src="'+k+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>刷新配置，完成<code>source /etc/profile</code></li></ol><h3 id="了解目录基本信息" tabindex="-1"><a class="header-anchor" href="#了解目录基本信息" aria-hidden="true">#</a> 了解目录基本信息</h3><figure><img src="'+f+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><figure><img src="'+x+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>
bin和etc目录下常用到的：
hdfs:存储相关命令
mapred:计算相关命令
yarn:资源调度相关命令
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hadoop运行模式" tabindex="-1"><a class="header-anchor" href="#hadoop运行模式" aria-hidden="true">#</a> Hadoop运行模式</h2><h3 id="_1、本地运行模式" tabindex="-1"><a class="header-anchor" href="#_1、本地运行模式" aria-hidden="true">#</a> 1、本地运行模式</h3>`,64),E={href:"https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Standalone_Operation",target:"_blank",rel:"noopener noreferrer"},I=a(`<h3 id="_2、伪分布式运行模式-略" tabindex="-1"><a class="header-anchor" href="#_2、伪分布式运行模式-略" aria-hidden="true">#</a> 2、伪分布式运行模式，略</h3><h3 id="_3、完全分布式运行模式" tabindex="-1"><a class="header-anchor" href="#_3、完全分布式运行模式" aria-hidden="true">#</a> 3、完全分布式运行模式</h3><p>分析：</p><ol><li>准备3台客户机（关闭防火墙、静态IP、主机名称）</li><li>安装JDK</li><li>配置环境变量</li><li>安装Hadoop</li><li>配置环境变量</li><li>配置集群</li><li>单点启动</li><li>配置ssh</li><li>群起并测试集群</li></ol><h3 id="_3-1-虚拟机准备-参考上文" tabindex="-1"><a class="header-anchor" href="#_3-1-虚拟机准备-参考上文" aria-hidden="true">#</a> <strong>3.1 虚拟机准备，参考上文</strong></h3><h3 id="_3-2-编写集群分发脚本xsync" tabindex="-1"><a class="header-anchor" href="#_3-2-编写集群分发脚本xsync" aria-hidden="true">#</a> <strong>3.2 编写集群分发脚本xsync</strong></h3><ul><li><p><strong>scp（secure copy）安全拷贝</strong></p><ol><li><p>scp 定义：scp 可以实现服务器与服务器之间的数据拷贝。（from server1 to server2）</p></li><li><p>基本语法</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>scp   -r    $pdir/$fname          $user@$host:$pdir/$fname 
命令  递归  要拷贝的文件路径/名称  目的地用户@主机：目的地路径/名称
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>案例实操</p><p>前提：在 hadoop102、hadoop103、hadoop104都已经创建好的/opt/module、/opt/software 两个目录，并且已经把这两个目录修改为 begin:begin</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>sudo chown begin:begin -R /opt/module
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>在 hadoop102 上，将hadoop102中/opt/module/jdk1.8.0_212 目录拷贝到hadoop103上</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>scp -r /opt/module/jdk1.8.0_212 begin@hadoop103:/opt/module
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>b. 在 hadoop103 上，将hadoop102中/opt/module/hadoop-3.1.3目录拷贝到hadoop103上</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>scp -r begin@hadoop102:/opt/module/hadoop3.1.3 /opt/module/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol></li><li><p><strong>rsync 远程同步工具</strong></p><p>rsync 主要用于备份镜像。具有速度快、避免复制相同内容和支持符号链接的优点。rsync 和 scp 区别：用 rsync 做文件的复制要比 scp 的速度快，rsync 只对差异文件更新。scp 是把所有文件都复制过去。</p><ol><li>基本语法</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>rsync  -av      $pdir/$fname           $user@$host:$pdir/fname
命令   选项参数  要拷贝的文件路径/名称  目的地用户@主机：目的地路径/名称

--------
选项参数说明：
-a  :归档拷贝
-v  :显示复制过程
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>案例实操</li></ol><p>a. 删除 hadoop103 中/opt/module/hadoop-3.1.3/wcinput</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>rm -rf wcinput
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>b. 同步 hadoop102 中的 /opt/module/hadoop-3.1.3 到 hadoop103</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>rsync  -av  hadoop-3.1.3/ begin@hadoop103:/opt/module/hadoop-3.1.3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>xsync集群分发脚本</strong></p></li></ul><ol><li><p>需求：循环复制文件到所有节点的相同目录下</p></li><li><p>需求分析：</p><ol><li>rsync命令原始拷贝</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>rsync -av  /opt/module   begin@hadoop104:/opt/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>b. 期望脚本：</p><p>xsync要同步的文件名称</p><p>c. 期望脚本在任何路径都能使用（脚本放在声明了全局环境变量的路径）</p><figure><img src="`+y+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure></li></ol><h3 id="_3-3-ssh无密登录配置" tabindex="-1"><a class="header-anchor" href="#_3-3-ssh无密登录配置" aria-hidden="true">#</a> <strong>3.3 SSH无密登录配置</strong></h3><ol><li><p>脚本实现</p><ol><li>在 /home/begin/bin 目录下创建xsync文件</li></ol><figure><img src="'+_+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><p>在该文件中编写如下代码</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>
#!/bin/bash

#1.判断参数格式
if [ $# -lt 1 ]
then
		echo Not Enough Arguement!
		exit;
fi
#2.遍历集群所有机器
for host in hadop102 hadoop103 hadoop104
do
	echo ------------------ $host ---------------------------
	#3.遍历所有目录，挨个发送
	
	for file in $@
	do
		#4.判断文件是否存在
		if [ -e $file ]
				then
						#5.获取父目录
						pdir=$(cd -P $(dirname $file); pwd)
						
						#6.获取当前文件的名称
						fname=$(basename $file)
						ssh $host &quot;mkdir -p $pdir&quot;
						rsync -av $pdir/$fname $host:$pdir
				else
						echo $file does not exists!
		fi
	done
done				 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>b. 修改脚本 xsync 具有执行权限</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>chmod +x xsync
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>c. 测试脚本</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>xsync /opt/software
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>d. 将脚本复制到/bin中，以便全局调用</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>sudo cp xsync /bin/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>e. 同步环境变量配置(root 所有者),<code>注意目录</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 ~] sudo ./bin/xsync /etc/profile.d/my_env.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>注意：如果使用了 sudo ，那么 xsync 一定要给它的路径补全</p></blockquote><p>让环境变量生效 <code>source /etc/profile</code></p><ol><li><p>配置 ssh</p><ul><li><p>基本语法</p><p>ssh另一台电脑的IP地址</p></li><li><p>ssh 链接是出现Host Key verification failed 的解决方法</p></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code> ssh hadoop103
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果出现如下内容</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>Are you sure you want to continue connecting (yes/no)?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输入 yes ,并回车</p><ul><li>退回到 hadoop102</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop103 ~]$ exit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>无秘钥配置</p><ul><li>免密登录原理</li></ul><figure><img src="`+A+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>生成 rsa 公钥私钥，注意文件目录，三次回车直接确定就好</li></ol><figure><img src="'+U+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><figure><img src="'+H+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>公钥拷贝至其他服务器，第一次需要密码</li></ol><figure><img src="'+w+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>完成后可直接链接</li></ol><figure><img src="'+q+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ol><li>免密登录文件</li></ol><figure><img src="'+N+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure></li></ol></li></ol><h3 id="_3-4-集群配置" tabindex="-1"><a class="header-anchor" href="#_3-4-集群配置" aria-hidden="true">#</a> 3.4 集群配置</h3>',11),B=a("<li><p><strong>集群部署规划</strong></p><p>注意：</p><blockquote><p>NameNode 和 SecondaryNameNode 不要安装在同一台服务器</p></blockquote><blockquote><p>ResourceManager 也很消耗内存，不要和NameNode、SecondaryNameNode 配置在同一台机器上。</p></blockquote><table><thead><tr><th></th><th>hadoop102</th><th>hadoop103</th><th>hadoop104</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode</td><td></td><td></td></tr><tr><td>DataNode</td><td></td><td></td><td></td></tr><tr><td>DataNode</td><td>SecondaryNameNode</td><td></td><td></td></tr><tr><td>DataNode</td><td></td><td></td><td></td></tr><tr><td>YARN</td><td></td><td></td><td></td></tr><tr><td>NodeManager</td><td>ResourceManager</td><td></td><td></td></tr><tr><td>NodeManager</td><td></td><td></td><td></td></tr><tr><td>NodeManager</td><td></td><td></td><td></td></tr></tbody></table></li>",1),$=a("<p><strong>配置文件说明</strong></p><p>Hadoop 配置文件分两类：默认配置文件和自定义配置文件，只有用户想修改某一默认配置值时，才需要修改自定义配置文件，更改相应属性值。</p><p>（1）默认配置文件：</p><table><thead><tr><th>要获取的默认文件</th><th>文件存放在 Hadoop 的 jar 包中的位置</th></tr></thead><tbody><tr><td>[core-default.xml]</td><td>hadoop-common-3.1.3.jar/core-default.xml</td></tr><tr><td>[hdfs-default.xml]</td><td>hadoop-hdfs-3.1.3.jar/hdfs-default.xml</td></tr><tr><td>[yarn-default.xml]</td><td>hadoop-yarn-common-3.1.3.jar/yarn-default.xml</td></tr><tr><td>[mapred-default.xml]</td><td>hadoop-mapreduce-client-core-3.1.3.jar/mapred-default.xml</td></tr></tbody></table><p>(2)、自定义配置文件：</p><p>core-site.xml、hdfs-site.xml、yarn-site.xml、mapred-site.xml 四个配置文件存放在 $HADOOP_HOME/etc/hadoop 这个路径上，用户可以根据项目需求重新进行修改配置。</p><blockquote><p>注意：Hadoop2.x和Hadoop3.x的自定义配置文件有一些改变</p></blockquote>",7),T={href:"http://hadoop-env.sh/",target:"_blank",rel:"noopener noreferrer"},F=n("p",null,"core-site.xml: 用于定义系统级别的参数，如HDFS URL、Hadoop的临时目录以及用于rack-aware集群中的配置文件的配置等，此中的参数定义会覆盖core-default.xml文件中的默认配置",-1),Y=n("p",null,"hdfs-site.xml: HDFS的相关设定，如文件副本的个数、块大小及是否使用强制权限等，此中的参数定义会覆盖hdfs-default.xml文件中的默认配置；",-1),V=n("p",null,"mapred-site.xml：HDFS的相关设定，如reduce任务的默认个数、任务所能够使用内存的默认上下限等，此中的参数定义会覆盖mapred-default.xml文件中的默认配置；",-1),C=a(`<li><p><strong>配置集群</strong></p><blockquote><p>先在单个节点上配置好，然后在向集群分发文件。</p></blockquote><ul><li>进入配置文件目录</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 ~]$ cd $HADOOP_HOME/etc/hadoop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>（1）核心配置文件</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ vim core-site.xml

# 在该文件中编写如下配置
<span class="token comment">&lt;!-- 指定HDFS中NameNode的地址  //内部通信地址，Web端无法通过8020访问 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hadoop102:8020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
      	<span class="token comment">&lt;!-- &lt;value&gt;hdfs://hadoop100:9000&lt;/value&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 指定 Hadoop 数据存储的目录 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/opt/module/hadoop-3.1.3/data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 配置 HDFS 网页登录使用的静态用户为 begin--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.http.staticuser.user<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>begin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 注：放在 &lt;configuration&gt; &lt;/configuration&gt; 中间 --&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>（2）HDFS配置文件</li></ul><p>配置<code>hadoop-env.sh</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[xqzhao@hadoop100 hadoop]$ vim hadoop-env.sh

# 修改如下选项
export JAVA_HOME=/opt/module/jdk1.8.0_144
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置<code>hdfs-site.xml</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ vim hdfs-site.xml

# 在该文件中编写如下配置
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- NameNode Web 端访问地址--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop102:9870<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- SecondaryNameNode Web端访问地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop104:9868<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(3) MapReduce配置文件</li></ul><p>配置<code>mapred-env.sh</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[xqzhao@hadoop100 hadoop]$ vim mapred-env.sh

# 修改如下选项
export JAVA_HOME=/opt/module/jdk1.8.0_144
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置<code>mapred-site.xml</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ vim mapred-site.xml

# 在该文件中增加如下配置
<span class="token comment">&lt;!-- 指定MR运行在Yarn上 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(4) YARN配置文件</li></ul><p>配置<code>yarn-env.sh</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[xqzhao@hadoop100 hadoop]$ vim yarn-env.sh

# 修改如下选项
export JAVA_HOME=/opt/module/jdk1.8.0_144
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置<code>yarn-site.xml</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ vim yarn-site.xml

# 在该文件中增加如下配置
<span class="token comment">&lt;!-- 指定 MapReduce 走 shuffle --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 指定 YARN 的 ResourceManager 的地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop103<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 环境变量的继承 //可以认为是解决了一个小Bug --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.env-whitelist<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>			
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>在集群上分发配置好的Hadoop配置文件</strong></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 etc]$ pwd
/opt/module/hadoop-3.1.3/etc
-----注意目录-----
[begin@hadoop102 etc]$ xsync hadoop/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>查看文件分发情况</strong></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ cat /opt/module/hadoop-3.1.3/etc/hadoop/core-site.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li>`,3),Z=a(`<h3 id="_3-5-群起集群" tabindex="-1"><a class="header-anchor" href="#_3-5-群起集群" aria-hidden="true">#</a> 3.5 群起集群</h3><ol><li><strong><strong>配置workers</strong></strong></li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 etc]$ cd /opt/module/hadoop-3.1.3/etc/hadoop
[begin@hadoop102 hadoop]$ vim workers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>在该文件中增加如下内容：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>hadoop100
hadoop101
hadoop102
# 注意：该文件中添加的内容结尾不允许有空格，文件中不允许有空行。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同步分发所有节点配置文件：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ xsync workers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>启动集群</li></ol><ul><li><p>(1) 如果集群是<code>**第一次启动**</code>，需要<strong>格式化</strong> <code>NameNode</code>。(<strong><code>格式化</code></strong>)</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#回到初始目录
[begin@hadoop102 hadoop-3.1.3]$ pwd
/opt/module/hadoop-3.1.3
#初始化
[begin@hadoop102 hadoop-3.1.3]$ hdfs namenode -format
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong><code>注意</code></strong>：格式化 NameNode ,会产生新的集群 id，导致 NameNode 和 DataNode 的集群 id 不一致,集群找不到已往数据。如果集群在运行过程中报错，需要重新格式化 NameNode 的话，一定要先<code>停止</code>上次启动的所有 <code>namenode</code>和 <code>datanode</code>进程，然后再删除集群中每台虚拟机上的 <code>data</code>和<code>logs</code>目录。</p></blockquote><p>出现如下两个文件表示初始化成功：</p><figure><img src="`+D+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure></li><li><p>(2) 启动<code>HDFS</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#启动
[begin@hadoop102 hadoop-3.1.3]$ sbin/start-dfs.sh
#查看102
[begin@hadoop102 hadoop-3.1.3]$ jps
2720 Jps
2455 DataNode
2331 NameNode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#查看103
[begin@hadoop103 ~]$ jps
1749 DataNode
1802 Jps
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#查看104
[begin@hadoop104 ~]$ jps 
2880 SecondaryNameNode
2917 Jps
2781 DataNode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>完成后可在浏览器打开如下界面<code>http://hadoop102:9870/</code>，打不开请检查防火墙和host文件</p><figure><img src="`+j+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure></li><li><p>(3) 在配置了<code>ResourceManger</code>的节点(<code>Hadoop103</code>)启动<code>YARN</code></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#注意要到配置了 ResourceManager 的节点执行命令，这里是103
[begin@hadoop103 hadoop-3.1.3]$ sbin/start-yarn.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop103 hadoop-3.1.3]$ sbin/start-yarn.sh 
Starting resourcemanager
resourcemanager is running as process 2009.  Stop it first.
Starting nodemanagers
hadoop102: nodemanager is running as process 2874.  Stop it first.
hadoop103: nodemanager is running as process 2140.  Stop it first.
[begin@hadoop103 hadoop-3.1.3]$ jps
1749 DataNode
2009 ResourceManager
2827 Jps
2140 NodeManager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注意：<code>NameNode</code>和<code>ResourceManger</code>如果不是同一台机器，不能在<code>NameNode</code>上启动 YARN，应该在<code>ResouceManager</code>所在的机器上启动YARN。</p></blockquote></li><li><p>(4) Web端查看 HDFS 的 <code>NameNode</code></p><p>浏览器中输入：<strong>http://hadoop102:9087</strong> 如下图：</p><figure><img src="`+O+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><p>Web端查看 YARN 的 <code>ResourceManager</code></p><p>浏览器中输入：<strong>http://hadoop103:8088</strong> 如下图:</p><figure><img src="'+R+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure></li><li><p>(5) 在 <code>Hadoop102</code> 上启动 <strong><code>历史服务器</code></strong></p><p>为了查看程序的历史运行情况，需要配置一下历史服务器。具体配置步骤如下：</p><ol><li>配置 mapred-site.xml</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#进入到指定路径下
[begin@hadoop102 hadoop]$ pwd
/opt/module/hadoop-3.1.3/etc/hadoop
[begin@hadoop102 hadoop]vim mapred-site.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在该文件里面增加如下配置</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!-- 历史服务器地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.adress<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop102:10020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 历史服务器web端地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.webapp.adress<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop102:19888<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>分发配置</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop] xsync mapred-site.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>在 hadoop102 启动历史服务器；注意：启动前需要重启 yarn 读取上面配置</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]bin/mapred --daemon start historyserver
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>查看历史服务器是否启动</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ jps
1364 NameNode
2730 Jps
1436 DataNode
2444 NodeManager
2668 JobHistoryServer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>查看 JobHistory</li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ sbin/mr-jobhistory-daemon.sh start historyserver
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong><code>注:</code></strong> 启动历史服务器之前，需要先进行相应的配置,</p><ol><li>配置日志的聚集</li></ol><ul><li>日志聚集概念：应用运行完成以后，将程序运行日志信息上传到HDFS系统上。</li><li>日志聚集功能好处：可以方便的查看到程序运行详情，方便开发调试。</li></ul><blockquote><p>注意：开启日志聚集功能，需要重新启动NodeManager 、ResourceManager和HistoryManager。</p></blockquote><p>开启日志聚集功能具体步骤如下：</p><ul><li>(1) 配置<code>yarn-site.xml</code></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop]$ vim yarn-site.xml

#在该文件里面增加如下配置。
<span class="token comment">&lt;!-- 开启日志聚集功能--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation-enable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 设置日志聚集服务器地址--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-server-url<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>http:hadoop102:19888/jobhistory/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 日志保留时间设置7天 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation.retain-seconds<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>604800<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>分发配置：<code>xsynv $HADOOP_HOME/etc/hadoop/yarn-site.xml</code></strong></p><ul><li>(2) 关闭<code>NodeManager</code> 、<code>ResourceManager</code>和<code>HistoryServer</code></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ sbin/yarn-daemon.sh stop resourcemanager
[begin@hadoop102 hadoop-3.1.3]$ sbin/yarn-daemon.sh stop nodemanager
[begin@hadoop102 hadoop-3.1.3]$ mapred --daemon stop historyserver
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(3) 启动<code>NodeManager</code> 、<code>ResourceManager</code>和<code>HistoryServer</code></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ sbin/yarn-daemon.sh start resourcemanager
[begin@hadoop102 hadoop-3.1.3]$ sbin/yarn-daemon.sh start nodemanager
[begin@hadoop102 hadoop-3.1.3]$ mapred --daemon start historyserver|
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(4) 删除HDFS上已经存在的输出文件</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ bin/hdfs dfs -rm -R /output
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>• (5) 执行WordCount程序</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ [begin@hadoop102 hadoop-3.1.3]$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar  wordcount /wcinput /wcoutput
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>(6) 查看日志</li></ul></li></ul><h3 id="_3-6-群起集群并测试" tabindex="-1"><a class="header-anchor" href="#_3-6-群起集群并测试" aria-hidden="true">#</a> 3.6 群起集群并测试</h3><ul><li>(1) 上传文件到集群</li></ul><p>上传小文件</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ hadoop fs -mkdir /wcinput
[begin@hadoop102 hadoop-3.1.3]$ hadoop fs -put wcinput/word.txt/wcinput
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>上传大文件</p><ul><li>(2) 上传文件后查看文件存放在什么位置</li></ul><p>查看HDFS文件存储路径</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>/opt/module/hadoop-3.1.3/data/dfs/data/current/BP-483549456-192.168.10.102-1667831825181/current/finalized/subdir0/subdir0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看HDFS在磁盘存储文件内容</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 subdir0]$ cat blk_1073741825
hadoop yarn
hadoop mapreduce 
begin
begin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+P+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><ul><li>(3) 拼接</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>-rw-rw-r--. 1 begin begin 134217728 11月 14 21:26 blk_1073741825
-rw-rw-r--. 1 begin begin   1048583 11月 14 21:26 blk_1073741825_1001.meta
-rw-rw-r--. 1 begin begin  13944814 11月 14 21:26 blk_1073741826
-rw-rw-r--. 1 begin begin    108951 11月 14 21:26 blk_1073741826_1002.meta
[begin@hadoop102 subdir0]$ cat blk_1073741836&gt;&gt;tmp.file
[begin@hadoop102 subdir0]$ cat blk_1073741837&gt;&gt;tmp.file
[begin@hadoop102 subdir0]$ tar -zxvf tmp.file
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(4) 下载</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ bin/hadoop fs -get /user/begin/input/hadoop-3.2.1.tar.gz ./
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>(5) 执行 wordcount 程序，查看 yarn 执行效果</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 hadoop-3.1.3]$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar  wordcount /wcinput /wcoutput
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="`+M+'" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><p>查看目录下执行结果</p><figure><img src="'+L+`" alt="Untitled" tabindex="0" loading="lazy"><figcaption>Untitled</figcaption></figure><h3 id="_3-7-集群启动-停止方式总结" tabindex="-1"><a class="header-anchor" href="#_3-7-集群启动-停止方式总结" aria-hidden="true">#</a> 3.7 集群启动/停止方式总结</h3><ul><li>（1）各个模块整体启动/停止 （配置 SSH 是前提）常用</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#整体启动/停止HDFS
[begin@hadoop102 hadoop-3.1.3]start-dfs.sh / stop-dfs.sh

#整体启动/停止YARN
[begin@hadoop102 hadoop-3.1.3]start-yarn.sh / stop-yarn.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>（2）分别启动/停止HDFS组件</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop102 /]$ hadoop-daemon.sh  start / stop  namenode / datanode / secondarynamenode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-8-两个常用脚本" tabindex="-1"><a class="header-anchor" href="#_3-8-两个常用脚本" aria-hidden="true">#</a> 3.8 两个常用脚本</h3><ul><li><strong><strong>myhadoop.sh集群启动/停止脚本</strong></strong></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#!/bin/bash

if [ $# -lt 1 ]
then
    echo &quot;No Args Input...&quot;
    exit ;
fi

case $1 in
&quot;start&quot;)
        echo &quot; =================== 启动 hadoop集群 ===================&quot;

        echo &quot; --------------- 启动 hdfs ---------------&quot;
        ssh hadoop102 &quot;/opt/module/hadoop-3.1.3/sbin/start-dfs.sh&quot;
        echo &quot; --------------- 启动 yarn ---------------&quot;
        ssh hadoop103 &quot;/opt/module/hadoop-3.1.3/sbin/start-yarn.sh&quot;
        echo &quot; --------------- 启动 historyserver ---------------&quot;
        ssh hadoop102 &quot;/opt/module/hadoop-3.1.3/bin/mapred --daemon start historyserver&quot;
;;
&quot;stop&quot;)
        echo &quot; =================== 关闭 hadoop集群 ===================&quot;

        echo &quot; --------------- 关闭 historyserver ---------------&quot;
        ssh hadoop102 &quot;/opt/module/hadoop-3.1.3/bin/mapred --daemon stop historyserver&quot;
        echo &quot; --------------- 关闭 yarn ---------------&quot;
        ssh hadoop103 &quot;/opt/module/hadoop-3.1.3/sbin/stop-yarn.sh&quot;
        echo &quot; --------------- 关闭 hdfs ---------------&quot;
        ssh hadoop102 &quot;/opt/module/hadoop-3.1.3/sbin/stop-dfs.sh&quot;
;;
*)
    echo &quot;Input Args Error...&quot;
;;
esac
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用：</p><p>[begin@hadoop102 hadoop-3.1.3]$ myhadoop.sh stop xsync文件内容(此文件存放于操作用户的~/bin中，并附加x执行权限)</p><ul><li><strong><strong>jpsall脚本查看各节点组件</strong></strong></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#!/bin/bash

for host in hadoop102 hadoop103 hadoop104
do
        echo =============== $host ===============
        ssh $host jps 
done
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-9-两道面试题-重点" tabindex="-1"><a class="header-anchor" href="#_3-9-两道面试题-重点" aria-hidden="true">#</a> 3.9 两道面试题 （重点）</h3>`,42),J={href:"https://www.notion.so/d8e269292a324c4d8d0b3fcebe1781fb",target:"_blank",rel:"noopener noreferrer"},K=a(`<h3 id="_4-0-集群时间同步-集群无法同步外网时间时使用" tabindex="-1"><a class="header-anchor" href="#_4-0-集群时间同步-集群无法同步外网时间时使用" aria-hidden="true">#</a> 4.0 集群时间同步（集群无法同步外网时间时使用）</h3><blockquote><p>时间同步的方式：找一个机器，作为<strong>时间服务器</strong> ，所有的机器与这台集群时间进行定时的同步，比如，每隔十分钟，同步一次时间。</p></blockquote><p>时间服务器配置（必须root用户）步骤:</p><ol><li><strong><strong>检查ntp是否安装</strong></strong></li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop102 bin]# rpm -qa|grep ntp

ntpdate-4.2.6p5-29.el7.centos.2.x86_64
ntp-4.2.6p5-29.el7.centos.2.x86_64

#未安装情况使用yum安装再执行操作
[root@hadoop102 bin]# sudo yum -y install ntp

#查看并设置所有节点ntpd服务状态和开机自启动状态
[root@hadoop102 bin]# sudo systemctl status ntpd
[root@hadoop102 bin]# sudo systemctl start ntpd
[root@hadoop102 bin]# sudo systemctl is-enabled ntpd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><strong><strong>修改hadoop102的 /etc/ntp.conf 配置文件</strong></strong></li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop102 /]$sudo vim /etc/ntp.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改内容如下:</p><ul><li>(1) 修改1（授权192.168.1.0-192.168.1.255网段上的所有机器可以从这台机器上查询和同步时间）</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap为
restrict 192.168.10.0 mask 255.255.255.0 nomodify notrap
(把前面的注释符’#&#39;去掉了)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(2) 修改2（集群在局域网中，不使用其他互联网上的时间）</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>server 0.centos.pool.ntp.org iburst
server 1.centos.pool.ntp.org iburst
server 2.centos.pool.ntp.org iburst
server 3.centos.pool.ntp.org iburst 为
#server 0.centos.pool.ntp.org iburst
#server 1.centos.pool.ntp.org iburst
#server 2.centos.pool.ntp.org iburst
#server 3.centos.pool.ntp.org iburst
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(3) 添加3（当该节点丢失网络连接，依然可以采用本地时间作为时间服务器为集群中的其他节点提供时间同步）</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>server 127.127.1.0
fudge 127.127.1.0 stratum 10
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><strong><strong>修改 /etc/sysconfig/ntpd 文件</strong></strong></li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop102 /]$sudo vim /etc/sysconfig/ntpd

增加内容如下（让硬件时间与系统时间一起同步）
SYNC_HWCLOCK=yes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><strong><strong>重新启动ntpd服务</strong></strong></li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop102 /]$ service ntpd status
service ntpd status

[root@hadoop102 /]$ service ntpd start
Starting ntpd:                                       [  OK  ]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><strong><strong>设置ntpd服务开机启动</strong></strong></li></ol><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop100 /]$ chkconfig ntpd on
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li><strong><strong>其他机器配置（必须root用户）</strong></strong></li></ol><p>执行前先关闭所有节点上 ntp 服务和自启动</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[begin@hadoop103 ~]$ sudo systemctl stop ntpd
[begin@hadoop103 ~]$ sudo systemctl disable ntpd
[begin@hadoop104 ~]$ sudo systemctl stop ntpd
[begin@hadoop104 ~]$ sudo systemctl disable ntpd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(1) 在其他机器配置10分钟与时间服务器同步一次</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop102 /]$ sudo crontab -e

编写定时任务如下：
*/10 * * * * /usr/sbin/ntpdate hadoop102
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>(2) 修改任意机器时间</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop103 /]$ sudo date -s &quot;2021-9-11 11:11:11&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>(3) 十分钟后查看机器是否与时间服务器同步</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[root@hadoop101 /]$ date
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>说明：测试的时候可以将10分钟调整为1分钟，节省时间。</p>`,30);function Q(X,W){const e=l("ExternalLinkIcon");return o(),d("div",null,[z,n("p",null,[s("参考官方文档："),n("a",E,[s("Apache Hadoop 3.3.4 – Hadoop: Setting up a Single Node Cluster."),t(e)])]),I,n("ol",null,[B,n("li",null,[$,n("p",null,[s("Hadoop2.x：core-site.xml、hdfs-site.xml、mapred-site.xml、yarn-site.xml、slaves Hadoop3.x：core-site.xml、hdfs-site.xml、mapred-site.xml、yarn-site.xml、workers "),n("a",T,[s("hadoop-env.sh"),t(e)]),s(": 用于定义hadoop运行环境相关的配置信息，比如配置JAVA_HOME环境变量、为hadoop的JVM指定特定的选项、指定日志文件所在的目录路径以及master和slave文件的位置等；")]),F,Y,V]),C]),Z,n("p",null,[n("a",J,[s("面试题及笔记"),t(e)])]),K])}const an=i(S,[["render",Q],["__file","hadoop-base.html.vue"]]);export{an as default};
